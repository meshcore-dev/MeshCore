/*
helpers/Battery.h defines battery chemistry types and their discharge curves
*/

class Battery {
public:
  // TYPE is a unique ID for battery chemistry type
  // NOTE: enum for curve must match index in table curve
  enum TYPE { BATT_LIPO, BATT_LIFEPO4 };
  uint16_t percent(uint8_t batt, uint16_t mv);

  // percent_col is the column index of the battery percentage in the below table
  const int percent_col = 2;

  // curve maps the battery voltage in mV to
  // the approximate SoC for a typical cell
  // Each column represents the mV for a given Soc foe that chemistry
  // COL1 = LIPO, COL2 = LIFEPO4, COL3 = percent charge
  // reference used https://blog.ampow.com/lipo-voltage-chart/
  // reference used https://cleversolarpower.com/lifepo4-voltage-chart/
  const uint16_t curve[100][3] = {
    { 4200, 3400, 100 }, { 4190, 3395, 99 }, { 4180, 3390, 98 }, { 4170, 3385, 97 }, { 4160, 3380, 96 },
    { 4150, 3375, 95 },  { 4142, 3370, 94 }, { 4134, 3365, 93 }, { 4126, 3360, 92 }, { 4118, 3355, 91 },
    { 4110, 3350, 90 },  { 4104, 3347, 89 }, { 4098, 3344, 88 }, { 4092, 3341, 87 }, { 4086, 3338, 86 },
    { 4080, 3335, 85 },  { 4068, 3332, 84 }, { 4056, 3329, 83 }, { 4044, 3326, 82 }, { 4032, 3323, 81 },
    { 4020, 3320, 80 },  { 4012, 0, 79 },    { 4004, 0, 78 },    { 3996, 0, 77 },    { 3988, 0, 76 },
    { 3980, 0, 75 },     { 3974, 0, 74 },    { 3968, 0, 73 },    { 3962, 0, 72 },    { 3956, 0, 71 },
    { 3950, 3300, 70 },  { 3942, 0, 69 },    { 3934, 0, 68 },    { 3926, 0, 67 },    { 3918, 0, 66 },
    { 3910, 0, 65 },     { 3902, 0, 64 },    { 3894, 0, 63 },    { 3886, 0, 62 },    { 3878, 0, 61 },
    { 3870, 3270, 60 },  { 3850, 0, 55 },    { 3848, 0, 54 },    { 3846, 0, 53 },    { 3844, 0, 52 },
    { 3842, 0, 51 },     { 3840, 3260, 50 }, { 3836, 0, 49 },    { 3832, 0, 48 },    { 3828, 0, 47 },
    { 3824, 0, 46 },     { 3820, 0, 45 },    { 3816, 0, 44 },    { 3812, 0, 43 },    { 3808, 0, 42 },
    { 3804, 0, 41 },     { 3800, 3250, 40 }, { 3798, 0, 39 },    { 3796, 0, 38 },    { 3794, 0, 37 },
    { 3792, 0, 36 },     { 3790, 0, 35 },    { 3786, 0, 34 },    { 3782, 0, 33 },    { 3778, 0, 32 },
    { 3774, 0, 31 },     { 3770, 3220, 30 }, { 3766, 0, 29 },    { 3762, 0, 28 },    { 3758, 0, 27 },
    { 3754, 0, 26 },     { 3750, 0, 25 },    { 3746, 0, 24 },    { 3742, 0, 23 },    { 3738, 0, 22 },
    { 3724, 0, 21 },     { 3730, 3200, 20 }, { 3726, 0, 19 },    { 3722, 0, 18 },    { 3718, 0, 17 },
    { 3714, 0, 16 },     { 3710, 0, 15 },    { 3706, 0, 14 },    { 3702, 0, 13 },    { 3698, 0, 12 },
    { 3694, 0, 11 },     { 3690, 3000, 10 }, { 3674, 0, 9 },     { 3658, 0, 8 },     { 3642, 0, 7 },
    { 3626, 0, 6 },      { 3610, 0, 5 },     { 3542, 0, 4 },     { 3474, 0, 3 },     { 3406, 0, 2 },
    { 3338, 0, 1 },      { 3270, 2500, 0 }
  };
};